<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>Color Theme Switcher | Hugo Test</title><meta name=keywords content="code,design"><meta name=description content="Let users customize your website with their favorite color scheme! Your site has a dark mode? That's cute. Mine has ten different themes now, and they're all named after Mario Kart race tracks."><meta name=author content><link rel=canonical href=https://polarhardboiled.github.io/hugotest/news/theme-switcher/color-theme-switcher/><link href=https://polarhardboiled.github.io/hugotest/assets/css/stylesheet.min.c747137dbc6318e57087bf41affe88d786d270168784c6950ebb1f280c6f7313.css integrity="sha256-x0cTfbxjGOVwh79Br/6I14bScBaHhMaVDrsfKAxvcxM=" rel="preload stylesheet" as=style><link rel=icon href=https://polarhardboiled.github.io/hugotest/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://polarhardboiled.github.io/hugotest/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://polarhardboiled.github.io/hugotest/favicon-32x32.png><link rel=apple-touch-icon href=https://polarhardboiled.github.io/hugotest/apple-touch-icon.png><link rel=mask-icon href=https://polarhardboiled.github.io/hugotest/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.78.2"></head><body class=single id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://polarhardboiled.github.io/hugotest accesskey=h>Hugo Test</a>
<span class=logo-switches><span class=theme-toggle><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span><div class="theme theme-mobile" data-ani=true><div class=dropdown><button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style=position:absolute;top:0 data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg></button><div class="dropdown-content select-theme"></div></div></div></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://polarhardboiled.github.io/hugotest/contact/><span>CÃ©moi</span></a></li><li><a href=https://polarhardboiled.github.io/hugotest/news/><span>L'Actu</span></a></li><li><a href=https://polarhardboiled.github.io/hugotest/search/><span>Recherche</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Color Theme Switcher</h1><div class=post-meta>29 November 2020</div></header><div class=post-content><p class=lead>Last year, the design gods decided that dark modes were the new hotness. "Light colors are for suckers", they laughed, drinking matcha tea on their fixie bikes or whatever.</p><p>And so every operating system, app and even some websites (mine included) suddenly had to come up with a dark mode. Fortunately though, this coincided nicely with widespread support for CSS <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/--*>custom properties</a> and the introduction of a new <code>prefers-color-scheme</code> media query.</p><p>There&rsquo;s lots of tutorials on <a href=https://css-tricks.com/dark-modes-with-css/>how to build dark modes</a> already, but why limit yourself to light and dark? Only a Sith deals in absolutes.</p><p>That&rsquo;s why I decided to build a new feature on my site:<br><strong>dynamic color themes!</strong> Yes, instead of two color schemes, I now have ten! That&rsquo;s eight better than the previous website!</p><p>Go ahead and try it, hit that <strong>paintroller-button</strong> in the header.<br>I&rsquo;ll wait.</p><p><em>If you&rsquo;re reading this somewhere else, the effect would look something like this:</em></p><figure class="teaser lazyload" data-expand=-110><video poster=theme-switcher-still.png controls>
<source src=../theme-switcher.mp4 type=video/mp4><source src=../theme-switcher.mp4 type=video/webm></video><figcaption>Encore mieux en visuel</figcaption></figure><p>Nice, right? Let&rsquo;s look at how to do that!</p><h2 id=define-color-schemes>Define Color Schemes<a hidden class=anchor aria-hidden=true href=#define-color-schemes>#</a></h2><p>First up, we need some data. We need to define our themes in a central location, so they&rsquo;re easy to access and edit. My site uses <a href=https://www.11ty.dev/>Eleventy</a>, which lets me create a simple JSON file for that purpose:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-json data-lang=json><span class=err>//</span> <span class=err>themes.json</span>
<span class=p>[</span>
    <span class=p>{</span>
        <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;bowser&#34;</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Bowser&#39;s Castle&#34;</span><span class=p>,</span>
        <span class=nt>&#34;colors&#34;</span><span class=p>:</span> <span class=p>{</span>
            <span class=nt>&#34;primary&#34;</span><span class=p>:</span> <span class=s2>&#34;#7f5af0&#34;</span><span class=p>,</span>
            <span class=nt>&#34;secondary&#34;</span><span class=p>:</span> <span class=s2>&#34;#2cb67d&#34;</span><span class=p>,</span>
            <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;#fffffe&#34;</span><span class=p>,</span>
            <span class=nt>&#34;border&#34;</span><span class=p>:</span> <span class=s2>&#34;#383a61&#34;</span><span class=p>,</span>
            <span class=nt>&#34;background&#34;</span><span class=p>:</span> <span class=s2>&#34;#16161a&#34;</span><span class=p>,</span>
            <span class=nt>&#34;primaryOffset&#34;</span><span class=p>:</span> <span class=s2>&#34;#e068fd&#34;</span><span class=p>,</span>
            <span class=nt>&#34;textOffset&#34;</span><span class=p>:</span> <span class=s2>&#34;#94a1b2&#34;</span><span class=p>,</span>
            <span class=nt>&#34;backgroundOffset&#34;</span><span class=p>:</span> <span class=s2>&#34;#29293e&#34;</span>
        <span class=p>}</span>
    <span class=p>},</span>
    <span class=p>{</span><span class=err>...</span><span class=p>}</span>
<span class=p>]</span>
</code></pre></td></tr></table></div></div><p>Our color schemes are objects in an array, which is now available during build. Each theme gets a <code>name</code>, <code>id</code> and a couple of color definitions. The parts of a color scheme depend on your specific design; In my case, I assigned each theme eight properties.</p><p>{% callout &ldquo;tip&rdquo; %}<br>It&rsquo;s a good idea to give these properties logical names instead of visual ones like &ldquo;light&rdquo; or &ldquo;muted&rdquo;, as colors vary from theme to theme. I&rsquo;ve also found it helpful to define a couple of &ldquo;offset&rdquo; colors - these are used to adjust another color on interactions like hover and such.<br>{% endcallout %}</p><p>In addition to the &ldquo;default&rdquo; and &ldquo;dark&rdquo; themes I already had before, I created eight more themes this way. I used a couple of different sources for inspiration; the ones I liked best are <a href=https://color.adobe.com/explore>Adobe Color</a> and <a href=https://www.happyhues.co/>happyhues</a>.</p><p>All my themes are named after Mario Kart 64 race tracks by the way, because why not.</p><h2 id=transform-to-custom-css-properties>Transform to Custom CSS Properties<a hidden class=anchor aria-hidden=true href=#transform-to-custom-css-properties>#</a></h2><p>To actually use our colors in CSS, we need them in a different format. Let&rsquo;s create a stylesheet and make custom properties out of them. Using Eleventy&rsquo;s template rendering, we can do that by generating a <code>theme.css</code> file from the data, looping over all themes. We&rsquo;ll use a macro to output the color definitions for each.</p><p>I wrote this in Nunjucks, the templating engine of my choice - but you can do it in any other language as well.</p><pre><code class=language-css{% data-lang=css{%>/* theme.css.njk */
---
permalink: '/assets/css/theme.css'
excludeFromSitemap: true
---
/*
  this macro will transform the colors in the JSON data
  into custom properties to use in CSS.
*/
{% macro colorscheme(colors) %}
    --color-bg: {{ colors.background }};
    --color-bg-offset: {{ colors.backgroundOffset }};
    --color-text: {{ colors.text }};
    --color-text-offset: {{ colors.textOffset }};
    --color-border: {{ colors.border }};
    --color-primary: {{ colors.primary }};
    --color-primary-offset: {{ colors.primaryOffset }};
    --color-secondary: {{ colors.secondary }};
{% endmacro %}

/* 
  get the &quot;default&quot; light and dark color schemes
  to use if no other theme was selected
*/
{%- set default = themes|getTheme('default') -%}
{%- set dark = themes|getTheme('dark') -%}

/*
  the basic setup will just use the light scheme
*/
:root {
    {{ colorscheme(default.colors) }}
}
/*
  if the user has a system preference for dark schemes,
  we'll use the dark theme as default instead
*/
@media(prefers-color-scheme: dark) {
    :root {
        {{ colorscheme(dark.colors) }}
    }
}

/*
  finally, each theme is selectable through a 
  data-attribute on the document. E.g:
  &lt;html data-theme=&quot;bowser&quot;&gt;
*/
{% for theme in themes %}
html[data-theme='{{ theme.id }}'] {
    {{ colorscheme(theme.colors) }}
}
{% endfor %}
{% endraw %}
</code></pre><h2 id=using-colors-on-the-website>Using colors on the website<a hidden class=anchor aria-hidden=true href=#using-colors-on-the-website>#</a></h2><p>Now for the tedious part - we need to go through all of the site&rsquo;s styles and replace every color definition with the corresponding custom property. This is different for every site - but your code might look like this if it&rsquo;s written in SCSS:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-scss data-lang=scss><span class=nt>body</span> <span class=p>{</span>
    <span class=nt>font-family</span><span class=nd>:</span> <span class=nt>sans-serif</span><span class=p>;</span>
    <span class=nt>line-height</span><span class=nd>:</span> <span class=err>$</span><span class=nt>line-height</span><span class=p>;</span>
    <span class=nt>color</span><span class=nd>:</span> <span class=err>$</span><span class=nt>gray-dark</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Replace the static SCSS variable with the theme&rsquo;s custom property:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-scss data-lang=scss><span class=nt>body</span> <span class=p>{</span>
    <span class=nt>font-family</span><span class=nd>:</span> <span class=nt>sans-serif</span><span class=p>;</span>
    <span class=nt>line-height</span><span class=nd>:</span> <span class=err>$</span><span class=nt>line-height</span><span class=p>;</span>
    <span class=nt>color</span><span class=nd>:</span> <span class=nt>var</span><span class=o>(</span><span class=nt>--color-text</span><span class=o>)</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>{% callout &ldquo;warning&rdquo; %}<br><strong>Attention:</strong> Custom Properties are supported in <a href="https://caniuse.com/#search=custom%20properties">all modern browsers</a>, but if you need to support IE11 or Opera Mini, be sure to provide a fallback.<br>{% endcallout %}</p><p>It&rsquo;s fine to mix static preprocessor variables and custom properties by the way - they do different things. Our line height is not going to change dynamically.</p><p>Now do this for every instance of <code>color</code>, <code>background</code>, <code>border</code>, <code>fill</code> &mldr; you get the idea. Told you it was gonna be tedious.</p><h2 id=building-the-theme-switcher>Building the Theme Switcher<a hidden class=anchor aria-hidden=true href=#building-the-theme-switcher>#</a></h2><p>If you made it this far, congratulations! Your website is now themeable (in theory). We still need a way for people to switch themes without manually editing the markup though, that&rsquo;s not very user-friendly. We need some sort of UI component for this - a theme switcher.</p><h3 id=generating-the-markup>Generating the Markup<a hidden class=anchor aria-hidden=true href=#generating-the-markup>#</a></h3><p>The switcher structure is pretty straightforward: it&rsquo;s essentially a list of buttons, one for each theme. When a button is pressed, we&rsquo;ll switch colors. Let&rsquo;s give the user an idea what to expect by showing the theme colors as little swatches on the button:</p><figure class=extend><img src="{{ 'theme-buttons.jpg' | media(page) }}" loading=lazy alt="a row of buttons, showing the theme name and color swatches"><figcaption>Fact: All good design is derivative of Mario Kart</figcaption></figure><p>Here&rsquo;s the template to generate that markup. We&rsquo;ll use inline style attributes here to display the background, text and accent colors. The button also holds its <code>id</code> in a <code>data-theme-id</code> attribute, we will pick that up with Javascript later.</p><pre><code class=language-html{% data-lang=html{%>&lt;ul class=&quot;themeswitcher&quot;&gt;
{% for theme in themes %}
    &lt;li class=&quot;themeswitcher__item&quot;&gt;
        &lt;button class=&quot;themeswitcher__btn&quot; data-theme-id=&quot;{{ theme.id }}&quot; style=&quot;background-color: {{ theme.colors.background }}&quot;&gt;
            &lt;span class=&quot;themeswitcher__name&quot; style=&quot;color: {{ theme.colors.text }}&quot;&gt;{{ theme.name }}&lt;/span&gt;
            &lt;span class=&quot;themeswitcher__palette&quot;&gt;
                &lt;span class=&quot;themeswitcher__hue&quot; style=&quot;background-color: {{ theme.colors.primary }}&quot;&gt;{{ theme.colors.primary }}&lt;/span&gt;
                &lt;span class=&quot;themeswitcher__hue&quot; style=&quot;background-color: {{ theme.colors.secondary }}&quot;&gt;{{ theme.colors.secondary }}&lt;/span&gt;
                &lt;span class=&quot;themeswitcher__hue&quot; style=&quot;background-color: {{ theme.colors.border }}&quot;&gt;{{ theme.colors.border }}&lt;/span&gt;
                &lt;span class=&quot;themeswitcher__hue&quot; style=&quot;background-color: {{ theme.colors.text }}&quot;&gt;{{ theme.colors.text }}&lt;/span&gt;
                &lt;span class=&quot;themeswitcher__hue&quot; style=&quot;background-color: {{ theme.colors.textOffset }}&quot;&gt;{{ theme.colors.textOffset }}&lt;/span&gt;
            &lt;/span&gt;
        &lt;/button&gt;
    &lt;/li&gt;
{% endfor %}
&lt;/ul&gt;
{% endraw %}
</code></pre><p>There&rsquo;s some styling involved as well, but I&rsquo;ll leave that out for brevity here. If you&rsquo;re interested in the extended version, you can find all the code in <a href=https://github.com/maxboeck/mxb>my site&rsquo;s github repo</a>.</p><p>{% signup &ldquo;By the way&mldr;&rdquo; %}<br>I&rsquo;m starting an email list for people interested in CSS and design experiments!<br>If you enjoy that kind of stuff, you can join here and I&rsquo;ll notify you whenever I publish a new post. No strings attached, unsubscribe anytime.<br>{% endsignup %}</p><h3 id=setting-the-theme>Setting the Theme<a hidden class=anchor aria-hidden=true href=#setting-the-theme>#</a></h3><p>The last missing piece is some Javascript to handle the switcher functionality.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// let&#39;s make this a new class
</span><span class=c1></span><span class=kr>class</span> <span class=nx>ThemeSwitcher</span> <span class=p>{</span>
    <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// define some state variables
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>activeTheme</span> <span class=o>=</span> <span class=s1>&#39;default&#39;</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>hasLocalStorage</span> <span class=o>=</span> <span class=k>typeof</span> <span class=nx>Storage</span> <span class=o>!==</span> <span class=s1>&#39;undefined&#39;</span>

        <span class=c1>// get all the theme buttons from before
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>themeSelectBtns</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;button[data-theme-id]&#39;</span><span class=p>)</span>
        <span class=c1>// when clicked, get the theme id and pass it to a function
</span><span class=c1></span>        <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>themeSelectBtns</span><span class=p>).</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>btn</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=kr>const</span> <span class=nx>id</span> <span class=o>=</span> <span class=nx>btn</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>themeId</span>
            <span class=nx>btn</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>setTheme</span><span class=p>(</span><span class=nx>id</span><span class=p>))</span>
        <span class=p>})</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=c1>// this whole thing only makes sense if custom properties are supported -
</span><span class=c1>// so let&#39;s check for that before initializing our switcher.
</span><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>CSS</span> <span class=o>&amp;&amp;</span> <span class=nx>CSS</span><span class=p>.</span><span class=nx>supports</span><span class=p>(</span><span class=s1>&#39;color&#39;</span><span class=p>,</span> <span class=s1>&#39;var(--fake-var)&#39;</span><span class=p>))</span> <span class=p>{</span>
    <span class=k>new</span> <span class=nx>ThemeSwitcher</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>When somebody switches themes, we&rsquo;ll take the theme id and set is as the <code>data-theme</code> attribute on the document. That will trigger the corresponding selector in our <code>theme.css</code> file, and the chosen color scheme will be applied.</p><p>Since we want the theme to persist even when the user reloads the page or navigates away, we&rsquo;ll save the selected id in <code>localStorage</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>setTheme</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// set the theme id on the &lt;html&gt; element...
</span><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>activeTheme</span> <span class=o>=</span> <span class=nx>id</span>
    <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>

    <span class=c1>// and save the selection in localStorage for later
</span><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>hasLocalStorage</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>localStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s2>&#34;theme&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>On a server-rendered site, we could store that piece of data in a cookie instead and apply the theme id to the html element before serving the page. Since we&rsquo;re dealing with a static site here though, there is no server-side processing - so we have to do a small workaround.</p><p>We&rsquo;ll retrieve the theme from <code>localStorage</code> in a tiny additional script in the head, right after the stylesheet is loaded. Contrary to the rest of the Javascript, we want this to execute as early as possible to avoid a FODT (&ldquo;flash of default theme&rdquo;).</p><p>OK that&rsquo;s not actually a real term. I made that up.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/assets/css/main.css&#34;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
        <span class=c1>// if there&#39;s a theme id in localstorage, use it on the &lt;html&gt;
</span><span class=c1></span>        <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;theme&#39;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> 
        <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>,</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;theme&#39;</span><span class=p>))</span>
    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>If no stored theme is found, the site uses the default color scheme (either light or dark, depending on the users <a href=https://web.dev/prefers-color-scheme/>system preference</a>).</p><h2 id=get-creative>Get creative<a hidden class=anchor aria-hidden=true href=#get-creative>#</a></h2><p>You can create any number of themes this way, and they&rsquo;re not limited to flat colors either - with some extra effort you can have patterns, gradients or even GIFs in your design. Although just because you can doesn&rsquo;t always mean you should, as is evidenced by my site&rsquo;s new <em>Rainbow Road</em> theme.</p><p>Please don&rsquo;t use that one.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://polarhardboiled.github.io/hugotest/tags/code>code</a></li><li><a href=https://polarhardboiled.github.io/hugotest/tags/design>design</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2020 <a href=https://polarhardboiled.github.io/hugotest>Hugo Test</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top" accesskey=g><button class=top-link id=top-link type=button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=https://polarhardboiled.github.io/hugotest/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>